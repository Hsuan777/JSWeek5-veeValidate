{"version":3,"sources":["products.js"],"names":["Vue","component","template","data","props","pages","type","Object","methods","emitPages","item","$emit","app","el","product","title","category","content","description","imageUrl","enabled","origin_price","price","unit","hexAPI","personID","apiPath","pagination","temporary","signout","e","preventDefault","document","cookie","token","window","location","getData","page","vm","replace","axios","defaults","headers","common","Authorization","get","then","res","meta","addProduct","post","initData","assign","copyData","updateData","id","forEach","patch","cleanDate","deleteData","created","mounted"],"mappings":"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","sourcesContent":["// Vue.component必須要放前面才不會報錯\r\n// Vue.component(`網頁標籤元件名稱`, {})\r\nVue.component(`pagination`, {\r\n  // 建立樣板\r\n  template: `\r\n  <nav aria-label=\"Page navigation example\">\r\n    <ul class=\"pagination mx-auto\">\r\n      <li class=\"page-item\" v-if=\"pages.current_page != 1\">\r\n        <a class=\"page-link\" href=\"#\" aria-label=\"Previous\" @click.prevent=\"emitPages(pages.current_page - 1)\">\r\n          <span aria-hidden=\"true\">&laquo;</span>\r\n        </a>\r\n      </li>\r\n      <li class=\"page-item\" v-for=\"(item, index) in pages.total_pages\" :key=\"index\">\r\n        <a class=\"page-link\" href=\"#\" @click.prevent=\"emitPages(item)\">\r\n          {{ item }}\r\n        </a>\r\n      </li>\r\n      \r\n      <li class=\"page-item\" v-if=\"pages.current_page != pages.total_pages\">\r\n        <a class=\"page-link\" href=\"#\" aria-label=\"Next\" @click.prevent=\"emitPages(pages.current_page + 1)\">\r\n          <span aria-hidden=\"true\">&raquo;</span>\r\n        </a>\r\n      </li>\r\n    </ul>\r\n  </nav>`,\r\n  // 定義資料，元件的 data必須使用 return的方式回傳資料，與 new Vue的 data不同\r\n  data() {\r\n    return {\r\n      // 此元件只會讀取該元件的 data資料\r\n    };\r\n  },\r\n  // 定義樣板屬性，用陣列方式定義，接著在網頁中寫 pages=某值或其他函式，資料就會寫入樣板中\r\n  // 但是範例為什麼是用物件? 可用來驗證傳入的資料，驗證型別(type)、自訂條件(validator)、預設值(default)等等\r\n  // props: [`pages`],\r\n  props: {\r\n    // pages:Object, //直接指定型別\r\n    pages:{\r\n      type:Object,\r\n      // validator:,\r\n      // default:``,\r\n    }\r\n  },\r\n  methods:{\r\n    emitPages(item){\r\n      this.$emit(`emit-pages`, item);\r\n    },\r\n  },\r\n})\r\n\r\nlet app = new Vue({\r\n  el: `#app`,\r\n  data: {\r\n    product: {\r\n      title: \"test\",\r\n      category: \"testCategory\",\r\n      content: \"test\",\r\n      description: \"test\",\r\n      imageUrl: [\"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1351&q=80\"],\r\n      enabled: true,\r\n      origin_price: `2000`,\r\n      price: `1000`,\r\n      unit: \"單位\"\r\n    },\r\n    hexAPI: {\r\n      personID: `85a8cd22-1b7d-43af-9b5a-5aa679129559`,\r\n      apiPath: `https://course-ec-api.hexschool.io/api/`,\r\n      data: [],\r\n    },\r\n    pagination:{},\r\n    temporary: [],\r\n  },\r\n  methods: {\r\n    // 功能類 //\r\n    signout(e) {\r\n      e.preventDefault();\r\n      // 將存放在瀏覽器的 cookie清空\r\n      document.cookie = `hexToken=; expires=; path=/`;\r\n      this.hexAPI.data = [];\r\n      this.hexAPI.token = ``,\r\n      window.location = \"index.html\";\r\n    },\r\n    /* 取得遠端 API資料 */\r\n    // 預設為 1\r\n    getData(page = 1) {\r\n      let vm = this;\r\n      // axios的驗證指令，Bearer是後端用的\r\n      const token = document.cookie.replace(/(?:(?:^|.*;\\s*)hexToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n      axios.defaults.headers.common.Authorization = `Bearer ${token}`;\r\n      axios\r\n        // 原本是 products ->最終結果是取得所有資料\r\n        // 改成 products?page=${page} -> 由後端給第一頁資料\r\n        .get(`${vm.hexAPI.apiPath}${vm.hexAPI.personID}/admin/ec/products?page=${page}`) \r\n        .then((res) => {\r\n          // 取得該頁資料\r\n          vm.hexAPI.data = res.data.data;\r\n          // 取得分頁資訊\r\n          vm.pagination = res.data.meta.pagination;\r\n        });\r\n    },\r\n    /* 新增資料 */\r\n    addProduct() {\r\n      let vm = this;\r\n      const token = document.cookie.replace(/(?:(?:^|.*;\\s*)hexToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n      axios.defaults.headers.common.Authorization = `Bearer ${token}`;\r\n      axios\r\n        .post(`${this.hexAPI.apiPath}${vm.hexAPI.personID}/admin/ec/product`, vm.temporary)\r\n        .then(() => {\r\n          vm.getData();\r\n        });\r\n    },\r\n    /* 新建資料 */\r\n    // 將 this.product的屬性值複製到暫存\r\n    initData() {\r\n      this.temporary = Object.assign({}, this.product);\r\n    },\r\n    /* 複製資料 */\r\n    // 將 v-for所取出的 item放入暫存\r\n    copyData(item) {\r\n      this.temporary = Object.assign({}, item);\r\n    },\r\n    /* 修改資料 */\r\n    updateData() {\r\n      let vm = this;\r\n      // if判斷，若有值則為 true\r\n      if (vm.temporary.id) {\r\n        vm.hexAPI.data.forEach((item) => {\r\n          if (vm.temporary.id === item.id) {\r\n            const token = document.cookie.replace(/(?:(?:^|.*;\\s*)hexToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n            axios.defaults.headers.common.Authorization = `Bearer ${token}`;\r\n            // patch跟 post一樣需要兩個參數 patch(`API網址`, 單一物件資料)，否則不會變更\r\n            axios\r\n              .patch(`${this.hexAPI.apiPath}${vm.hexAPI.personID}/admin/ec/product/${vm.temporary.id}`, vm.temporary)\r\n              .then(() => {\r\n                vm.getData();\r\n                vm.cleanDate();\r\n              });\r\n          }\r\n        })\r\n      } else {\r\n        vm.addProduct();\r\n      }\r\n      vm.cleanDate();\r\n    },\r\n    /* 刪除資料 */\r\n    deleteData() {\r\n      let vm = this;\r\n      vm.hexAPI.data.forEach((item) => {\r\n        if (vm.temporary.id === item.id) {\r\n          const token = document.cookie.replace(/(?:(?:^|.*;\\s*)hexToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n          axios.defaults.headers.common.Authorization = `Bearer ${token}`;\r\n          axios\r\n            .delete(`${this.hexAPI.apiPath}${vm.hexAPI.personID}/admin/ec/product/${vm.temporary.id}`)\r\n            .then(() => {\r\n              vm.getData();\r\n              vm.cleanDate();\r\n            });\r\n        }\r\n      })\r\n    },\r\n    // 工具類 //\r\n    cleanDate() {\r\n      this.temporary = {};\r\n    },\r\n  },\r\n  // 資料建立之後，適合處理資料\r\n  created() {\r\n    // 取出 token 名稱，若為空值則跳回 login.html，防止直接進 products.html\r\n    const token = document.cookie.replace(/(?:(?:^|.*;\\s*)hexToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n    if( token === ``){\r\n      window.location = \"login.html\";\r\n    }\r\n    this.getData();\r\n  },\r\n  // 元件渲染 html後，適合處理 DOM\r\n  mounted() {\r\n    \r\n  }\r\n})\r\n\r\n\r\n"],"file":"products.js"}